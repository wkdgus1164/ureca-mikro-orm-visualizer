# Phase 4: 최적화 및 개선

**목표**: UI/UX 개선, 성능 최적화, 사용자 경험 향상

**예상 완료 기간**: 1-2주

**의존성**: Phase 3 완료 필수

---

## 진행 상황

- [ ] Undo/Redo 기능 실제 구현
- [ ] 자동 레이아웃 (dagre)
- [ ] 키보드 단축키
- [ ] 성능 최적화
- [ ] 다크모드 개선
- [ ] 접근성 개선
- [ ] 사용자 가이드 및 튜토리얼

---

## 핵심 목표

1. ✅ Undo/Redo 기능으로 실수 복구 가능
2. ✅ 자동 레이아웃으로 다이어그램 정리 가능
3. ✅ 키보드 단축키로 빠른 작업 가능
4. ✅ 대규모 다이어그램에서도 원활한 성능
5. ✅ 접근성 및 사용성 개선

---

## 필수 기능

### 1. Undo/Redo 기능 실제 구현

**기능:**
- 노드 추가/삭제, 엣지 추가/삭제, 프로퍼티 편집 등 모든 액션 추적
- Undo: 이전 상태로 되돌리기
- Redo: 되돌린 액션 다시 실행

**구현:**
- 상태 히스토리 스택
- 각 액션마다 히스토리 푸시
- Undo: 히스토리 pop 및 상태 복원

**UI:**
- 툴바 Undo/Redo 버튼 활성화
- 키보드 단축키: Cmd/Ctrl+Z, Cmd/Ctrl+Shift+Z

---

### 2. 자동 레이아웃 (dagre)

**기능:**
- 현재 노드들을 자동으로 정렬
- 계층 구조 반영 (트리 레이아웃)
- 방향 선택 (좌→우, 상→하)

**구현:**
- dagre 라이브러리 사용
- 노드 위치 계산 및 업데이트

**UI:**
- 툴바 "Auto Layout" 버튼
- 방향 선택 드롭다운

---

### 3. 키보드 단축키

**단축키 목록:**
- **Cmd/Ctrl+Z**: Undo
- **Cmd/Ctrl+Shift+Z**: Redo
- **Cmd/Ctrl+S**: Save
- **Cmd/Ctrl+O**: Load
- **Cmd/Ctrl+E**: Export
- **Delete**: 선택한 노드/엣지 삭제
- **Cmd/Ctrl+C**: 복사
- **Cmd/Ctrl+V**: 붙여넣기
- **Cmd/Ctrl+D**: 복제
- **Cmd/Ctrl+A**: 전체 선택

**구현:**
- 키보드 이벤트 리스너
- 각 단축키에 액션 매핑

---

### 4. 성능 최적화

**최적화 항목:**
- 노드 렌더링 최적화 (React.memo)
- 대규모 다이어그램 (100+ 노드) 성능 테스트
- 불필요한 리렌더링 방지
- 코드 생성 로직 최적화 (memoization)

**측정:**
- Chrome DevTools Performance 탭
- Lighthouse 성능 점수

---

### 5. 다크모드 개선

**개선 사항:**
- ReactFlow 컴포넌트 다크모드 스타일링
- 노드/엣지 색상 다크모드 최적화
- 툴바, 패널 다크모드 색상 조정

---

### 6. 접근성 개선

**접근성 항목:**
- ARIA 레이블 추가
- 키보드 네비게이션
- 스크린 리더 지원
- 색상 대비 (WCAG AA 기준)

---

### 7. 사용자 가이드 및 튜토리얼

**가이드 내용:**
- 첫 방문 시 온보딩 튜토리얼
- 툴팁 추가 (버튼 hover 시 설명)
- 도움말 모달

---

## 작업 단위 (Task Breakdown)

### Task 4.1: Undo/Redo 기능 구현

**담당**: State Management
**예상 난이도**: High
**의존성**: Phase 3 완료

**세부 작업:**
1. 상태 히스토리 관리 훅 구현
2. 각 액션마다 히스토리 푸시
3. Undo/Redo 로직 구현
4. 툴바 버튼 활성화

**완료 조건:**
- [ ] useHistory 훅 구현
- [ ] Undo/Redo 동작 확인
- [ ] 키보드 단축키 동작

**커밋 메시지 템플릿:**
```
feat(editor): Undo/Redo 기능 구현

- useHistory 훅으로 상태 히스토리 관리
- 노드/엣지 추가/삭제, 편집 액션 추적
- Undo/Redo 로직 구현
- 키보드 단축키 (Cmd/Ctrl+Z, Cmd/Ctrl+Shift+Z)

관련 Task: Phase 4 - Task 4.1
```

---

### Task 4.2: 자동 레이아웃 구현

**담당**: Layout Engine
**예상 난이도**: Medium
**의존성**: Phase 3 완료

**세부 작업:**
1. dagre 패키지 설치
2. 자동 레이아웃 함수 구현
3. 툴바 "Auto Layout" 버튼 추가

**완료 조건:**
- [ ] dagre 레이아웃 적용
- [ ] 방향 선택 (LR, TB)
- [ ] Auto Layout 버튼 동작

**커밋 메시지 템플릿:**
```
feat(editor): 자동 레이아웃 기능 구현 (dagre)

- dagre 패키지 설치
- 자동 레이아웃 함수 구현
- 툴바 Auto Layout 버튼 추가
- 방향 선택 (좌→우, 상→하)

관련 Task: Phase 4 - Task 4.2
참고: https://reactflow.dev/examples/layout/dagre
```

---

### Task 4.3: 키보드 단축키 구현

**담당**: Keyboard Shortcuts
**예상 난이도**: Medium
**의존성**: Phase 3 완료

**세부 작업:**
1. 키보드 이벤트 리스너 추가
2. 단축키 매핑
3. 단축키 목록 표시 (도움말)

**완료 조건:**
- [ ] 모든 단축키 동작
- [ ] 단축키 충돌 방지
- [ ] 도움말에 단축키 목록 표시

**커밋 메시지 템플릿:**
```
feat(editor): 키보드 단축키 구현

- 키보드 이벤트 리스너 추가
- Cmd/Ctrl+Z (Undo), Cmd/Ctrl+S (Save) 등 단축키 매핑
- 단축키 목록 도움말 모달
- 단축키 충돌 방지 로직

관련 Task: Phase 4 - Task 4.3
```

---

### Task 4.4: 성능 최적화

**담당**: Performance
**예상 난이도**: Medium
**의존성**: Phase 3 완료

**세부 작업:**
1. 노드 컴포넌트 React.memo
2. 불필요한 리렌더링 방지
3. 코드 생성 로직 memoization
4. 성능 측정 및 개선

**완료 조건:**
- [ ] React.memo 적용
- [ ] 리렌더링 최소화
- [ ] Lighthouse 성능 점수 90+ (모바일)

**커밋 메시지 템플릿:**
```
perf(editor): 성능 최적화

- 노드/엣지 컴포넌트 React.memo 적용
- 불필요한 리렌더링 방지 (useMemo, useCallback)
- 코드 생성 로직 memoization
- Lighthouse 성능 점수 90+ 달성

관련 Task: Phase 4 - Task 4.4
```

---

### Task 4.5: 접근성 개선

**담당**: Accessibility
**예상 난이도**: Low
**의존성**: Phase 3 완료

**세부 작업:**
1. ARIA 레이블 추가
2. 키보드 네비게이션 개선
3. 색상 대비 확인

**완료 조건:**
- [ ] ARIA 레이블 추가
- [ ] 키보드 네비게이션 동작
- [ ] WCAG AA 색상 대비 준수

**커밋 메시지 템플릿:**
```
feat(a11y): 접근성 개선

- ARIA 레이블 추가 (버튼, 입력 필드 등)
- 키보드 네비게이션 개선
- WCAG AA 색상 대비 준수
- 스크린 리더 테스트

관련 Task: Phase 4 - Task 4.5
```

---

## 제외 사항

Phase 4에서 구현하지 않는 것들:
- ❌ 협업 기능 (실시간 편집, 댓글 등) - 추후 논의
- ❌ 버전 관리 (Git 연동 등) - 추후 논의

---

## 성공 메트릭

Phase 4 완료 기준:
1. ✅ Undo/Redo 기능 동작
2. ✅ 자동 레이아웃 기능 동작
3. ✅ 키보드 단축키 모두 동작
4. ✅ Lighthouse 성능 점수 90+ (모바일)
5. ✅ WCAG AA 접근성 준수

---

## 프로젝트 완료

Phase 4 완료 시:
- ✅ 모든 Phase PRD 완료
- ✅ MVP → 고급 기능 → DB 연동 → 최적화 순차 완료
- ✅ Vercel 배포 준비
- ✅ 사용자 피드백 수집 및 추가 개선 계획 수립
